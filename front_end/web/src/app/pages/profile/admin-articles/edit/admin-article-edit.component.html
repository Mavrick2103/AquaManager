<mat-card class="wrap">
  <div class="top">
    <button mat-stroked-button type="button" (click)="back()">
      <mat-icon>arrow_back</mat-icon>
      Retour
    </button>

    <div class="title">
      <h2>Modifier l’article</h2>
      <p *ngIf="article">#{{ article.id }} • {{ article.slug }}</p>
    </div>

    <button mat-stroked-button type="button" (click)="openPublic()" [disabled]="!article">
      <mat-icon>open_in_new</mat-icon>
      Voir public
    </button>
  </div>

  <div class="loading" *ngIf="loading">
    <mat-progress-spinner mode="indeterminate" diameter="22"></mat-progress-spinner>
    <span>Chargement…</span>
  </div>

  <form *ngIf="!loading" class="form" [formGroup]="form" (ngSubmit)="save()">
    <div class="grid">
      <mat-form-field appearance="outline" class="span2">
        <mat-label>Titre *</mat-label>
        <input matInput formControlName="title" />
      </mat-form-field>

      <mat-form-field appearance="outline" class="span2">
        <mat-label>Extrait</mat-label>
        <input matInput formControlName="excerpt" />
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Statut *</mat-label>
        <mat-select formControlName="status">
          <mat-option value="DRAFT">Brouillon</mat-option>
          <mat-option value="PUBLISHED">Publié</mat-option>
        </mat-select>
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Thème *</mat-label>
        <mat-select formControlName="themeId">
          <mat-option *ngFor="let t of themes" [value]="t.id">{{ t.name }}</mat-option>
        </mat-select>
      </mat-form-field>

      <mat-form-field appearance="outline" class="span2">
        <mat-label>Cover image URL</mat-label>
        <input matInput formControlName="coverImageUrl" />
      </mat-form-field>

      <mat-form-field appearance="outline" class="span2">
        <mat-label>Contenu *</mat-label>
        <textarea matInput rows="12" formControlName="content"></textarea>
      </mat-form-field>
    </div>

    <div class="actions">
      <button mat-flat-button color="primary" type="submit" [disabled]="saving || deleting">
        <mat-icon>save</mat-icon>
        {{ saving ? 'Sauvegarde…' : 'Sauvegarder' }}
      </button>

      <button mat-stroked-button color="warn" type="button" (click)="delete()" [disabled]="saving || deleting">
        <mat-icon>delete</mat-icon>
        {{ deleting ? 'Suppression…' : 'Supprimer' }}
      </button>
    </div>
  </form>
</mat-card>
